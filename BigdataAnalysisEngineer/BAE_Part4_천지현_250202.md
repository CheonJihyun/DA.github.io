# PART 04 빅데이터 결과 해석

## CHAPTER 01 분석 모형 평가 및 개선

### 1. 분석 모형 평가

#### 평가 지표: 분석 모형의 성능을 평가하는 기준

회귀 모형 평가 지표: 실제 값과 예측 값의 차이(오차)를 다양한 방식으로 평균하여 계산한 지표

- 평균절대오차(MAE): 오차 절댓값의 평균, 직관적, 에러 크기 그대로 반영
- 평균제곱오차(MSE): 오차 제곱의 평균, 값이 커지는 경향이 있음
- 평균제곱근오차(RMSE): MSE에 제곱근
- 평균절대백분율오차(MAPE): MAE를 퍼센트로 변환, 다른 변수 간 오차 비교 가능

결정계수($R^2$): 선형 회귀 모형이 실제 데이터를 얼마나 잘 설명하는지 나타내는 지표, 1에 가까울수록 설명력 높음

- SST: 전체제곱합, y가 가지는 전체 변동
- SSR: 회귀제곱합, y가 가지는 전체 변동성 중 회귀모형으로 설명할 수 있는 변동
- SSE: 오차제곱합, y가 가지는 전체 변동성 중 회귀모형으로 설명할 수 없는 변동

분류 모형 평가 지표

- 분류 모형의 예측 결과는 참/거짓과 같은 범주 형태
- 예측 값이 실제 값과 많이 일치할수록 모형이 예측을 잘함
- 정확도: 전체 데이터 중 예측을 정확하게 한 데이터의 비율
- 정밀도: Positive로 예측한 데이터 중 실제 Positive인 데이터 비율
- 재현율, 민감도: 실제 Positive인 데이터 중 모형이 Positive로 예측한 데이터 비율
- 특이도: 실제 Negative인 데이터 중 모형이 Negative로 예측한 데이터 비율
- F1-Score: 정밀도와 재현율의 조화평균
- 거짓 긍정률: 실제 Negative인 데이터 중 모형이 Positive로 예측한 데이터의 비율(= 1-특이도)
- 참 긍정률: 실제 Positive인 데이터 중 모형이 Positive로 예측한 데이터의 비율(= 재현율, 민감도)

혼동행렬: 분류모형이 예측한 값과 실제 값의 조합을 표 형태로 나타낸 것

ROC 곡선

- 임계값이 0~1로 변화할 때의 곡선
- x축은 거짓긍정률, y축은 참 긍정률
- AUC: 곡선 아래의 면적, 1에 가까울수록 분류 모델 성능이 좋음

#### 분석 모형 진단: 분석에 사용된 데이터가 분석 모형 가정을 제대로 만족하는지 확인

회귀모형진단

- 선형성: 종속변수는 독립변수의 선형함수, 잔차 산점도의 선형성 확인
- 독립성: 독립변수 사이에는 상관관계 없어야, 잔차 산점도에 경향성이 없는지 확인/더빈-왓슨 검정
- 등분산성: 오차항의 분산은 등분산이다, 잔차 산점도가 고르게 분포해야
- 정규성: 오차항의 평균은 0, 샤피로-윌크 검정/콜모고로프-스미르노프 적합성 검정/Q-Q plot

분석모형 오류

- 일반화 오류: 과대적합, 학습데이터 특성을 지나치게 반영
- 학습 오류: 과소적합, 학습 데이터 특성을 부족하게 반영

#### 교차검증: 데이터의 일부는 분석 모형 학습에 사용, 나머지는 모델 검증에 사용 -> 반복

K-fold 교차 검증

- k개의 fold로 나누어 (k-1)개는 학습에, 나머지 한 개는 검증에 사용
- k개의 평가 지표 값 평균을 성능 지표로 사용

Hold-out 교차 검증

- 데이터를 무작위로 7:3 또는 8:2 비율로 학습 데이터와 검증 데이터로 나눔

Leave-p-out 교차 검증

- 데이터 중 p개의 관측치만 검증 데이터로 사용하고 나머지는 학습 데이터로
- p=1인 경우 리브-원-아웃 교차 검증이라고 하기도

#### 모수의 유의성 검정: 수집된 자료가 통계적으로 유의한지 판단

- 모수 검정: 모집단의 분포를 가정 -> 집단 간 차이를 검정
- 비모수 검정: 모집단이 특정 분포를 가정 X -> 집단 간 차이를 검정, n=30 미만이거나 서열/명목 척도인 경우

모집단에 대한 유의성 검정

- z-검정: 추출된 표본이 모집단에 속하는지 검증
- t-검정: 평균값 검증(1-way), 두 집단의 평균 비교(2-way)
- 분산분석(ANOVA): 두 개 이상 집단의 평균 비교
- 카이제곱 검정: 분산을 알고 있을 때 두 집단의 동질성 겁정
- F-검정: 두 모집단 분산 차이가 유의한지 검정

#### 적합도 검정: 통계 분포가 관측치에 얼마나 잘 맞는지

- Q-Q plot: 정규분포에 얼마나 가까운지 시각적으로 표현
- 카이제곱 검정: 독립인지 아닌지 확인, 범주형 데이터에 사용
- 샤피로 윌크 검정: 데이터의 정규성 검증
- 콜모고로프 스미르노프 검정: 예산 분포와 얼마나 잘 맞는지, 연속형 데이터에 적용 가능

### 2. 분석 모형 개선

- 과대적합(오버피팅): 분석 모형이 학습 데이터에 지나치게 적합, 일반화 X
- 과소적합(언더피팅): 분석 모형이 학습 데이터에서 패턴을 충분히 학습하지 못한 것

#### 과대적합 방지

- 학습 데이터 수 증가
- 가중치 규제 (L1규제, L2규제)
- 교차 검증

#### 매개변수 최적화

매개변수 최적화: 손실함수(결과값과 실제값의 차이)의 값을 가장 작게 만드는 매개변수의 최적값을 찾아나가는 과정

경사하강법: 손실함수 기울기를 통해 최적값을 구하는 방법

- 배치 경사하강법(BGD): 전체 데이터, 부드럽게 수렴, 느린 속도
- 확률적 경사 하강법(SGD): 무작위 1개 선택, 오차율 크고 불안정하게 수렴, 빠른 속도
- 미니 배치 경사하강법: 무작위 10~1000개 데이터 선택, BGD보다 빠르고  SGD보다 낮은 오차율

모멘텀

- 확률적 경사하강법의 매개변수 변경 방향에 가속도를 부여하는 방식
- 모멘텀 계수 알파는 하이퍼파라미터(보통 0.9로 설정)

AdaGrad

- 매개변수마다 학습률을 다르게 적용
- 값이 많이 변한 매개변수일수록 학습률 낮춤
- 장점: 자동으로 학습률 변경
- 단점: 최적값 도달 전 학습률이 0에 가까워짐

RMSProp

- AdaGrad의 개선된 방법
- 새로운 하이퍼파라미터 로우를 도입, 로우가 작을수록 최근 기울기 더 많이 반영

Adam

- 모멘텀 + RMSProp
- 매개변수의 번경 방향과 폭을 모두 적절히 조절 가능
- 가장 많이 사용됨

#### 분석 모형 융합(앙상블): 다양한 종류의 분석 모형 결합

보팅(Voting): 여러 개의 분석 모형 결과를 종합

- 직접 투표(Hard voting): 많이 선택된 클래스를 최종 결과로 예측
- 간접 투표(Soft voting): 각 모형의 클래스 확률값을 평균내어 확률이 가장 높은 클래스를 최종 결과로 예측

배깅(Bagging): 일정한 크기의 부트스트랩 샘플을 무작위 복원 추출해서 학습 -> 종합해서 최종 분석모형 도출

부스팅(Boosting): 약한 분석 모형 어러 개를 연결해서 강한 분석 모형을 만듦

- 정답에는 낮은 가중치, 오답에는 높은 가중치 -> 오답을 더 잘 맞추도록 학습시킴


스태킹(Stacking): 여러 분석모형 예측을 종합

#### 최종모형 선정

- 최종모형 평가 기준 선정: 성능 지표 활용
- 분석모형 평가: 훈련에 사용하지 않은 데이터로 평가
- 최종모형 선정: 예측 성눙, 분석 모형 반영 가능 여부 고렽

## CHAPTER 02 분석 결과 해석 및 활용

### 1. 분석 결과 해석

#### 분석 모형 해석

- 해석 가능한 모형: 선형 회귀, 로지스틱 회귀, 의사결정 나무 등, 간단하고 직관적, 예측 정확도 낮음
- 순열 변수 중요도: 특정 변수를 제외했을때 손실을 계싼 -> 변수의 중요도 파악, 대표적이고 직관적
- 부분 의존도 plot: 중요 변수를 1~2개 선택 후 어떤 영향을 미치는지 확인

#### 비즈니스 기여도 평가: 실제 업무에 적용됐을 때의 개선 효과 정량적 평가

- 투자 대비 효과(ROI): 순 효과/총 비용
- 순현재가치(NPV): 편익의 현재 가치 - 비용의 현재 가치 (순현재가치>0 -> 타당성 있는 사업)
- 내부 수익률(IRR): 순현재가치=0이 되게하는 할인율 (IRR > 요구수익률 -> 투자 적합)
- 총 소유비용(TCO): 자산 획득 시의 비용 + 제반 비용 등 총 비용
- 투자 회수 기간(PP): 누적 현금 흐름이 흑자로 돌아서는 시점까지의 기간

### 분석 결과 시각화

#### 시각화

- 목적: 데이터 분석, 의사소통 수단
- 분류: 데이터 시각화, 정보 시각화, 정보 디자인
- 프로세스: 정보 구조화 -> 정보 시각화 -> 정보 시각표현

#### 시간 시각화

- 시간에 따른 데이터의 변화를 보여줌
- x축: 시간, y축: 데이터 값
- 막대 그래프, 산점도, 선 그래프, 계단식 그래프, 영역 차트

#### 공간 시각화

- 데이터를 지도 위에 표현하는 방법
- 지리 정보가 중요할 때
- 등치지역도, 도트 플롯 맵, 버블 플롯 맵, 등치선도, 카토그램

#### 관계 시각화

- 변수 간의 연관성, 분포 패턴을 찾기 위한 방법
- 산점도, 산점도 행렬, 버블 차트, 히스토그램

#### 비교 시각화

- 여러 변수의 값들을 비교하고 싶을 때 사용
- 히트맵, 스타 차트, 체르노프 페이스, 평행 좌표 그래프

#### 인포그래픽

- 복잡한 데이터를 그래픽으로 쉽게 표현하는 방법
- 데이터 시각화와 달리 raw data 취급 X
- 정보 디자인의 목적: 객관적 정보 전달하는 정보성 메시지 담는 것(지하철 노선도), 주장하는 바인 설득형 메시지를 담는 것(사회적인 메시지)

### 분석 결과 활용

#### 분석 모형 전개: 분석 결과를 확장 적용하는 단계

- 운영 시스템 구성, 분석 모형이 개발된 툴/언어, 운영 요건별로 다르게 적용

#### 분석 결과 활용 시나리오 개발: 분석 결과를 의사결정에 반영

- 이니사이트 발굴 및 확장
- 의사결정 방법 선택
- 차트 및 시각화 도구 선택

#### 분석 모형 모니터링: 개선 필요 시점 파악

- 분석 모형 모니터링 주기
- 분석 모형 성능 측정 항목
- 분석 모형 재학습: 최신 데이터로 주기적으로 분석 모형 학습, 모니터링 성능 떨어지면 새로운 분석 모형 구축

#### 분석 모형 리모델링: 새로운 데이터 및 변수 추가, 알고리즘 반영 등

- 기존 분석 모형 분석
- 데이터 수집 및 전처리
- 분석 모형 구축
- 최종 분석 모형 선정 및 반영
